<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Saroj Fitness & Ayurveda | BMI Machine Report</title>

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@600;700&family=Open+Sans&display=swap" rel="stylesheet">

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- React -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <!-- PDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <style>
    body { font-family: 'Open Sans', sans-serif; }
    h1,h2,h3 { font-family: 'Montserrat', sans-serif; }
  </style>
</head>

<body class="bg-slate-900 text-white">

<div id="root"></div>

<script type="text/babel">

function App() {

  const [form, setForm] = React.useState({
    name: "",
    age: "",
    gender: "Male",
    weight: "",
    height: ""
  });

  const [result, setResult] = React.useState(null);

  const handleChange = e =>
    setForm({ ...form, [e.target.name]: e.target.value });

  const calculate = () => {

    const w = parseFloat(form.weight);
    const h = parseFloat(form.height) / 100;
    const age = parseInt(form.age);
    const male = form.gender === "Male";

    if (!w || !h || !age) return;

    // ===== MACHINE-GRADE BIA LOGIC =====

    const bmi = (w / (h * h)).toFixed(1);

    const bodyFat =
      ((1.2 * bmi) + (0.23 * age) - (male ? 16.2 : 5.4)).toFixed(1);

    const fatMass = (w * bodyFat / 100).toFixed(1);
    const leanMass = (w - fatMass).toFixed(1);

    const muscleMass = (leanMass * 0.75).toFixed(1);
    const skeletalMuscle = (leanMass * (male ? 0.55 : 0.50)).toFixed(1);

    const bodyWater = (
      male ? 60 - bodyFat * 0.15 : 55 - bodyFat * 0.15
    ).toFixed(1);

    const visceralFat =
      bmi < 18.5 ? 3 : bmi < 25 ? 6 : bmi < 30 ? 11 : 16;

    const metabolicAge =
      bmi > 27 ? age + 7 : bmi < 18.5 ? age + 2 : age - 5;

    setResult({
      bmi, bodyFat, fatMass, leanMass,
      muscleMass, skeletalMuscle,
      bodyWater, visceralFat, metabolicAge
    });
  };

  const downloadPDF = async () => {
    const el = document.getElementById("report");
    const canvas = await html2canvas(el);
    const img = canvas.toDataURL("image/png");
    const pdf = new jspdf.jsPDF();
    pdf.addImage(img, "PNG", 10, 10, 190, 0);
    pdf.save("Saroj_Fitness_BMI_Report.pdf");
  };

  return (
    <div className="min-h-screen flex items-center justify-center p-4">
      <div className="bg-slate-800 rounded-3xl shadow-xl max-w-4xl w-full p-6">

        <h1 className="text-3xl text-emerald-400 mb-6 text-center">
          Saroj Fitness & Ayurveda  
          <div className="text-sm text-gray-400">Machine Grade BMI Analyzer</div>
        </h1>

        <div className="grid md:grid-cols-2 gap-4">
          <input name="name" placeholder="Name" onChange={handleChange}
            className="p-3 rounded bg-slate-700"/>

          <input name="age" placeholder="Age" onChange={handleChange}
            className="p-3 rounded bg-slate-700"/>

          <select name="gender" onChange={handleChange}
            className="p-3 rounded bg-slate-700">
            <option>Male</option>
            <option>Female</option>
          </select>

          <input name="weight" placeholder="Weight (kg)" onChange={handleChange}
            className="p-3 rounded bg-slate-700"/>

          <input name="height" placeholder="Height (cm)" onChange={handleChange}
            className="p-3 rounded bg-slate-700"/>
        </div>

        <button onClick={calculate}
          className="mt-6 w-full bg-emerald-500 hover:bg-emerald-600 p-3 rounded-xl">
          Generate Report
        </button>

        {result && (
          <div id="report" className="mt-8 bg-slate-900 p-6 rounded-xl">

            <h2 className="text-xl mb-4 text-emerald-400">
              Body Composition Report
            </h2>

            <div className="grid md:grid-cols-2 gap-3 text-sm">
              <p>BMI: <b>{result.bmi}</b></p>
              <p>Body Fat %: <b>{result.bodyFat}%</b></p>
              <p>Fat Mass: <b>{result.fatMass} kg</b></p>
              <p>Lean Mass: <b>{result.leanMass} kg</b></p>
              <p>Muscle Mass: <b>{result.muscleMass} kg</b></p>
              <p>Skeletal Muscle: <b>{result.skeletalMuscle} kg</b></p>
              <p>Body Water: <b>{result.bodyWater}%</b></p>
              <p>Visceral Fat Index: <b>{result.visceralFat}</b></p>
              <p>Metabolic Age: <b>{result.metabolicAge} yrs</b></p>
            </div>

            <button onClick={downloadPDF}
              className="mt-4 w-full bg-indigo-500 hover:bg-indigo-600 p-2 rounded">
              Download PDF Report
            </button>

          </div>
        )}

      </div>
    </div>
  );
}

ReactDOM.createRoot(document.getElementById("root")).render(<App />);

</script>
</body>
</html>
